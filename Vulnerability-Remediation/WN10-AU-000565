
<#
.SYNOPSIS
    This PowerShell script ensures that the maximum size of the Windows Application event log is at least 32768 KB (32 MB).

.NOTES
    Author          : Gerardo Sierra
    GitHub          : github.com/
    Date Created    : 05-20-2025
    Last Modified   : 05-20-2025
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AU-000565

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\__remediation_template(STIG-ID-WN10-AU-000500).ps1 
#>

# YOUR CODE GOES HERE

# Step 1: Enable "Force audit policy subcategory settings to override 
audit policy category settings" 
$lsaPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa" 
$overrideValueName = "SCENoApplyLegacyAuditPolicy" 
$overrideValueData = 0  # 0 = Enabled 
# Ensure LSA key exists and set value 
if (-not (Test-Path $lsaPath)) { 
New-Item -Path $lsaPath -Force | Out-Null 
} 
Set-ItemProperty -Path $lsaPath -Name $overrideValueName -Value 
$overrideValueData -Type DWord 
Write-Output "Set SCENoApplyLegacyAuditPolicy = 0 (Enabled audit 
policy subcategories)" 
# Step 2: Configure "Audit Other Logon/Logoff Events - Failure" 
# This must be done with auditpol.exe as there's no registry 
equivalent 
# Check current setting 
$auditStatus = (auditpol /get /subcategory:"Other Logon/Logoff 
Events") -join "`n" 
if ($auditStatus -notmatch "Failure") { 
Write-Output "Setting 'Audit Other Logon/Logoff Events - Failure'" 
auditpol /set /subcategory:"Other Logon/Logoff Events" 
/failure:enable | Out-Null 
} else { 
Write-Output "'Audit Other Logon/Logoff Events - Failure' is 
already enabled" 
} 
# Final check 
Write-Output "Updated Audit Policy:" 
auditpol /get /subcategory:"Other Logon/Logoff Events"
