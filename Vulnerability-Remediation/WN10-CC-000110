<#
.SYNOPSIS
    This PowerShell script requires that Windows 10 systems must prevent users from installing printer drivers.

.NOTES
    Author          : Gerardo Sierra
    GitHub          : github.com/
    Date Created    : 2024-09-09
    Last Modified   : 2024-09-09
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-CC-000110

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
#>

# YOUR CODE GOES HERE

# Ensure the script is run as Administrator 
if (-not ([Security.Principal.WindowsPrincipal] 
[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security
 .Principal.WindowsBuiltInRole]::Administrator)) { 
Write-Warning "You must run this script as Administrator." 
exit 
} 
# Registry path and desired value 
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers" 
$regName = "DisableHTTPPrinting" 
$desiredValue = 1 
# Create the registry key if it doesn't exist 
if (-not (Test-Path $regPath)) { 
New-Item -Path $regPath -Force | Out-Null 
Write-Host "
 ‚úÖ
 Created registry key: $regPath" 
} 
# Set the registry value 
try { 
Set-ItemProperty -Path $regPath -Name $regName -Value 
$desiredValue -Type DWord 
Write-Host "
 ‚úÖ
 Set $regName to $desiredValue at $regPath" 
} catch { 
Write-Error "
 ‚ùå
 Failed to set $regName: $_" 
} 
# Confirm result 
Write-Host "`n
 üîç
 Current value:" 
Get-ItemProperty -Path $regPath | Select-Object $regName
